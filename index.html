<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>몰래몰레</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.css" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <!-- ── 인트로 (메인메뉴) ── -->
    <div class="intro-screen" id="introScreen">
        <div class="intro-content">
            <h1 class="intro-title">몰래몰레</h1>
            <nav class="intro-nav">
                <button class="intro-btn primary" onclick="navigateTo('rules')">게임 시작</button>
                <button class="intro-btn" onclick="navigateTo('collection')">콜렉션</button>
                <button class="intro-btn" onclick="navigateTo('settings')">설정</button>
                <button class="intro-btn exit" disabled>종료</button>
            </nav>
        </div>
        <div class="intro-moles">
            <!-- 일반 두더지 -->
            <div class="intro-mole-hole">
                <div class="mole-char">
                    <div class="mole-ear left"></div><div class="mole-ear right"></div>
                    <div class="mole-body"></div>
                    <div class="mole-head">
                        <div class="spy-glasses"><div class="glass left"></div><div class="glass-bridge"></div><div class="glass right"></div></div>
                        <div class="mole-eye left"><div class="pupil"></div></div>
                        <div class="mole-eye right"><div class="pupil"></div></div>
                        <div class="mole-snout"><div class="mole-nose"></div></div>
                        <div class="mole-teeth"><div class="mole-tooth"></div><div class="mole-tooth"></div></div>
                    </div>
                </div>
            </div>
            <!-- 일반 두더지 -->
            <div class="intro-mole-hole">
                <div class="mole-char">
                    <div class="mole-ear left"></div><div class="mole-ear right"></div>
                    <div class="mole-body"></div>
                    <div class="mole-head">
                        <div class="spy-glasses"><div class="glass left"></div><div class="glass-bridge"></div><div class="glass right"></div></div>
                        <div class="mole-eye left"><div class="pupil"></div></div>
                        <div class="mole-eye right"><div class="pupil"></div></div>
                        <div class="mole-snout"><div class="mole-nose"></div></div>
                        <div class="mole-teeth"><div class="mole-tooth"></div><div class="mole-tooth"></div></div>
                    </div>
                </div>
            </div>
            <!-- 스파이 두더지 (3번째) -->
            <div class="intro-mole-hole spy">
                <div class="mole-char">
                    <div class="mole-ear left"></div><div class="mole-ear right"></div>
                    <div class="mole-body"></div>
                    <div class="mole-head">
                        <div class="spy-glasses"><div class="glass left"></div><div class="glass-bridge"></div><div class="glass right"></div></div>
                        <div class="mole-eye left"><div class="pupil"></div></div>
                        <div class="mole-eye right"><div class="pupil"></div></div>
                        <div class="mole-snout"><div class="mole-nose"></div></div>
                        <div class="mole-teeth"><div class="mole-tooth"></div><div class="mole-tooth"></div></div>
                    </div>
                </div>
            </div>
            <!-- 일반 두더지 -->
            <div class="intro-mole-hole">
                <div class="mole-char">
                    <div class="mole-ear left"></div><div class="mole-ear right"></div>
                    <div class="mole-body"></div>
                    <div class="mole-head">
                        <div class="spy-glasses"><div class="glass left"></div><div class="glass-bridge"></div><div class="glass right"></div></div>
                        <div class="mole-eye left"><div class="pupil"></div></div>
                        <div class="mole-eye right"><div class="pupil"></div></div>
                        <div class="mole-snout"><div class="mole-nose"></div></div>
                        <div class="mole-teeth"><div class="mole-tooth"></div><div class="mole-tooth"></div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ── 게임 방법 (구 시작화면) ── -->
    <div class="start-screen hidden" id="startScreen">
        <button class="screen-back-btn" onclick="history.back()">← 뒤로</button>
        <h2>몰래몰레</h2>
        <p>두더지를 잡아라! 하지만 스파이를 조심해!</p>

        <div class="mole-demo">
            <div class="demo-item">
                <div class="demo-mole">
                    <div class="mole-char">
                        <div class="mole-ear left"></div>
                        <div class="mole-ear right"></div>
                        <div class="mole-body"></div>
                        <div class="mole-head">
                            <div class="spy-glasses">
                                <div class="glass left"></div>
                                <div class="glass-bridge"></div>
                                <div class="glass right"></div>
                            </div>
                            <div class="mole-eye left"><div class="pupil"></div></div>
                            <div class="mole-eye right"><div class="pupil"></div></div>
                            <div class="mole-snout"><div class="mole-nose"></div></div>
                            <div class="mole-teeth"><div class="mole-tooth"></div><div class="mole-tooth"></div></div>
                        </div>
                    </div>
                </div>
                <div class="demo-label good">일반 두더지 (클릭!)</div>
            </div>
            <div class="demo-item">
                <div class="demo-mole spy">
                    <div class="mole-char">
                        <div class="mole-ear left"></div>
                        <div class="mole-ear right"></div>
                        <div class="mole-body"></div>
                        <div class="mole-head">
                            <div class="spy-glasses">
                                <div class="glass left"></div>
                                <div class="glass-bridge"></div>
                                <div class="glass right"></div>
                            </div>
                            <div class="mole-eye left"><div class="pupil"></div></div>
                            <div class="mole-eye right"><div class="pupil"></div></div>
                            <div class="mole-snout"><div class="mole-nose"></div></div>
                            <div class="mole-teeth"><div class="mole-tooth"></div><div class="mole-tooth"></div></div>
                        </div>
                    </div>
                </div>
                <div class="demo-label bad">스파이 두더지 (피해!)</div>
            </div>
        </div>

        <div class="rules">
            <h3>게임 규칙</h3>
            <ul>
                <li>매 턴 두더지 3마리 등장 (일반 2 + 스파이 1)</li>
                <li>일반 두더지 1마리만 클릭하세요</li>
                <li>스파이 두더지(선글라스)를 클릭하면 게임 오버!</li>
                <li>시간 내에 클릭하지 못하면 게임 오버!</li>
            </ul>
        </div>

        <button class="btn" onclick="startGame()">게임 시작</button>
    </div>

    <!-- ── 콜렉션 ── -->
    <div class="sub-screen collection-screen hidden" id="collectionScreen">
        <button class="screen-back-btn" onclick="history.back()">← 뒤로</button>
        <h2 class="coll-title">콜렉션</h2>
        <div class="coll-tabs">
            <button class="coll-tab active" data-tab="normal" onclick="switchCollTab('normal')">일반</button>
            <button class="coll-tab" data-tab="hidden" onclick="switchCollTab('hidden')">히든 🔒</button>
        </div>
        <div class="coll-cats" id="collCats"></div>
        <div class="coll-grid" id="collGrid"></div>
    </div>

    <!-- ── 설정 ── -->
    <div class="sub-screen hidden" id="settingsScreen">
        <button class="screen-back-btn" onclick="history.back()">← 뒤로</button>
        <h2>설정</h2>
        <p style="opacity:0.6;margin-top:12px">준비 중입니다...</p>
    </div>

    <!-- ── 게임 종료 화면 ── -->
    <div class="end-screen hidden" id="endScreen">
        <h2>게임 오버!</h2>
        <p id="endReason"></p>
        <div class="stats">
            <p>총 점수: <span id="finalScore">0</span>점</p>
            <p id="newRecordMsg" class="hidden new-record">🏆 신기록!</p>
            <p>최고 기록: <span id="allTimeBest">-</span>점</p>
            <p>평균 반응속도: <span id="avgReaction">0</span>ms</p>
            <p>최고 반응속도: <span id="bestReaction">0</span>ms</p>
            <hr style="border-color:rgba(255,255,255,0.2);margin:10px 0">
            <p>해당 스테이지 제한시간: <span id="stageTimeLimit">-</span>초</p>
            <p>두더지 등장 후 경과: <span id="elapsedTime">-</span>ms</p>
        </div>
        <button class="btn" onclick="startGame()">다시 시작</button>
        <button class="btn" style="margin-top:10px;background:rgba(255,255,255,0.15);font-size:1rem" onclick="navigateTo('intro')">메인메뉴</button>
    </div>

    <!-- ── 게임 화면 ── -->
    <div id="gameHeader">
        <div class="stage-bar">
            <div class="stage-num"><span id="score">0</span>탄</div>
            <div class="prev-rt hidden" id="prevRtWrap">이전 <span id="prevRtVal">-</span>ms</div>
        </div>
        <button id="pauseBtn" class="pause-btn hidden" onclick="togglePause()">⏸ 일시정지</button>
    </div>
    <div id="boardWrapper">
        <div class="game-container">
            <div class="grid" id="grid"></div>
        </div>
    </div>

    <!-- ── 물총 ── -->
    <div class="gun-wrap hidden">
        <div class="gun" id="gun">
            <div class="gun-tank"></div>
            <div class="gun-barrel"></div>
            <div class="gun-muzzle"></div>
            <div class="gun-grip"></div>
            <div class="muzzle-point" id="muzzlePoint"></div>
        </div>
    </div>

    <!-- ── 선물 팝업 ── -->
    <div class="gift-popup hidden" id="giftPopup">
        <div class="gift-popup-box">
            <span class="gift-popup-emoji" id="giftEmoji">🎁</span>
            <h3>선물 획득!</h3>
            <p id="giftName">새 아이템</p>
            <button class="btn" id="giftClose">수집하기</button>
        </div>
    </div>

    <!-- ── 일시정지 오버레이 ── -->
    <div class="pause-overlay hidden" id="pauseOverlay">
        <h2>⏸ 일시정지</h2>
        <button class="btn" onclick="togglePause()">▶ 계속하기</button>
        <button class="btn quit-btn" onclick="quitGame()">✕ 게임 중단</button>
    </div>

    <script src="script.js"></script>
</body>
</html>
